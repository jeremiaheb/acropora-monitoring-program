---
page-layout: custom
sidebar: false
toc: true
format: html
---

:::::: grid
::: g-col-2
:::

::: g-col-6
```{r}
#| label: setup-and-process
#| message: false
#| warning: false
#| echo: false

# Source all custom functions for the analysis
source("code/dataFunctions.R")

# Load the raw data from the data directory
library(readxl)
TaggedColonies <- read_xlsx("data/TaggedColonies.xlsx")

# Process and summarize the data by calling the functions
Tagged_Metrics <- wrangle_coral_data(TaggedColonies)
site_summary <- summarize_site_metrics(Tagged_Metrics)
binned_proportions <- calculate_binned_proportions(Tagged_Metrics)
```
::: {.panel-tabset}
## LAI

::: {.panel-tabset}
### All
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

plot_metric_over_time(
  summary_data = site_summary,
  y_var = LAI_mean,
  y_se = LAI_se,
  title = "Mean Live Area Index (LAI) Over Time by Site",
  y_lab = "Mean LAI (± SE)"
)
```

### St. Thomas
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

site_summary %>%
  filter(Island == "St. Thomas") %>%
  plot_metric_over_time(
    summary_data = .,
    y_var = LAI_mean,
    y_se = LAI_se,
    title = "Mean Live Area Index (LAI) Over Time by Site",
    y_lab = "Mean LAI (± SE)"
  )
```

### St. John
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

site_summary %>%
  filter(Island == "St. John") %>%
  plot_metric_over_time(
    summary_data = .,
    y_var = LAI_mean,
    y_se = LAI_se,
    title = "Mean Live Area Index (LAI) Over Time by Site",
    y_lab = "Mean LAI (± SE)"
  )
```

### St. Croix
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

site_summary %>%
  filter(Island == "St. Croix") %>%
  plot_metric_over_time(
    summary_data = .,
    y_var = LAI_mean,
    y_se = LAI_se,
    title = "Mean Live Area Index (LAI) Over Time by Site",
    y_lab = "Mean LAI (± SE)"
  )
```

:::

## Percent Cover

::: {.panel-tabset}
### All
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

plot_metric_over_time(
  summary_data = site_summary,
  y_var = Perc_Live_mean,
  y_se = Perc_Live_se,
  title = "Mean Percent Living Tissue Over Time by Site",
  y_lab = "Mean % Living Tissue (± SE)"
)
```

### St. Thomas
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

site_summary %>%
  filter(Island == "St. Thomas") %>%
  plot_metric_over_time(
    summary_data = .,
    y_var = Perc_Live_mean,
    y_se = Perc_Live_se,
    title = "Mean Percent Living Tissue Over Time by Site",
    y_lab = "Mean % Living Tissue (± SE)"
  )
```

### St. John
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

site_summary %>%
  filter(Island == "St. John") %>%
  plot_metric_over_time(
    summary_data = .,
    y_var = Perc_Live_mean,
    y_se = Perc_Live_se,
    title = "Mean Percent Living Tissue Over Time by Site",
    y_lab = "Mean % Living Tissue (± SE)"
  )
```

### St. Croix
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

site_summary %>%
  filter(Island == "St. Croix") %>%
  plot_metric_over_time(
    summary_data = .,
    y_var = Perc_Live_mean,
    y_se = Perc_Live_se,
    title = "Mean Percent Living Tissue Over Time by Site",
    y_lab = "Mean % Living Tissue (± SE)"
  )
```

:::

## Distributions

::: {.panel-tabset}
### All
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

plot_size_distribution(binned_proportions)
```

### St. Thomas
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

binned_proportions %>%
  filter(Island == "St. Thomas") %>%
  plot_size_distribution(.)
```

### St. John
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

binned_proportions %>%
  filter(Island == "St. John") %>%
  plot_size_distribution(.)
```

### St. Croix
```{r}
#| message: false
#| warning: false
#| echo: false
#| out-width: "100%"

binned_proportions %>%
  filter(Island == "St. Croix") %>%
  plot_size_distribution(.)
```

:::

:::

:::

::: g-col-4
:::
::::::